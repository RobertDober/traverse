defmodule Test.Traverse.VisitTest do
  use ExUnit.TestCase
  alias Support.Collector

  describe "a complex ds" do
    test "with collector" do
      Collector.start_link
      ds = [1, %{a: [2, 3]}, {4, 5}]
      expected = [
        :open_list, 1, :open_map,
           :open_tuple, :a, :open_list, 2, 3, :close_list, :close_tuple,
        :close_map, :open_tuple,
           4, 5,
        :close_tuple, :close_list
      ]
      Traverse.visit(ds, Collector)
      result = Collector.messages
      assert result == expected
    end
  end
end
